# 2.1 실제 데이터로 작업하기

**머신러닝을 배울 때는 인공적으로 만들어진 데이터셋이 아닌 실제 데이터셋으로 실험해보는 것이 가장 좋다.** 

여러 사이트 소개는 책 참고

# 2.2 큰 그림 보기

캘리포니아 인구 조사 데이터를 사용 캘리포니아의 주택 가격모델을 만들자

- 캘리포니아의 블록 그룹마다 인구
- 중간 소득
- 중간 주택 가격
- etc….

## 2.2.1 문제정의

### 비즈니스의 목적이 정확히 무엇인가?

**목적을 아는 것**은 문제를 어떻게 구성할지, 어떤 알고리즘을 선택할지, 모델 평가에 어떤 성능 지표를 사용할지, 모델 튜닝을 위해 얼마 만큼의 노력을 투여할지 결정하기 때문에 아주 중요!!!

### 파이프라인

데이터 처리 컴포넌트들이 연속되어 있는 것을 데이터 파이프라인이라고 한다.

### 현재 솔루션은 어떻게 구성되어 있나요?

현재 가지고 있는 정보들을 가지고 어떻게 시스템을 설계할지 생각해 본다!

- 어떤 학습 방법을 선택할 것인가?
- 분류? 회귀? 아니면 다른 작업인가?
- 배치학습과 온라인 학습 중 어느 것을 사용해야 하는ㄱ?
- 뚜둔!
    - 레이블된 훈련 샘플이 있으므로 전형적인 **지도학습**
    - 모델이 값을 예측해야 하기 때문에 **회귀!**
        - 특성이 여러개이기 때문에 **다중 회귀**
        - 각 구역마다 하나의 값을 예측하므로 **단변량 회귀**
        - 구역마다 여러 개의 값을 예측한다면 **다변량 회귀**
    - 시스템으로 들어오는 데이터에 연속적인 흐름이 없으므로 빠르게 변하는 데이터에 적응하지 않아도 되고, 데이터가 메모리에 들어갈 만큼 충분히 작으므로 일반적인 **배치 학습**
    

## 2.2.2 성능 측정 지표 선택

회귀 문제의 전형적인 성능 지표는 **평균 제곱근 오차(RMSE)**이다.

![](https://velog.velcdn.com/images/hth623/post/0f856546-22a3-4d42-8649-1950cd3e2f18/image.png)

출처 https://helpingstar.github.io/ml/regression_metrics/
### 표기법

- m은 RMSE를 측정할 데이터셋에 있는 샘플 수입니다.
- $X^{(i)}$는 데이터셋에 있는 i번째 샘플(레이블 제외)의 전체 **특성값의 벡터**이다.
- X는 데이터셋에 있는 모든 샘플의 모든 특성값(레이블 제외)을 포함하는 행렬이다.
    - 샘플 하나가 하나의 행이어서 i번째 행은 $X^{(i)}$의 전치와 같고 $(X^{(i)})^T$
- $y^{(i)}$ 는 해당 **레이블**(해당 샘플의 기대 출력값)이다.
- $h$는 시스템의 예측 함수이며 가설이라고도 한다. 예측값 $\hat{y} = h(X^{(i)})$을 출력 예측값 뽑는 함수를 지칭하는거… 알았는데…알고리즘이라고 생각해도 될 듯
- $RMSE(X,h)$는 가설 $h$를 사용하여 일련의 샘플을 평가하는 비용 함수이다.

이상치로 보이는 구역이 많다면 **평균 절대 오차(MAE)**를 고려할 수 있다.

![](https://velog.velcdn.com/images/hth623/post/ae015865-09ab-44ed-acac-b1def2138738/image.png)

출처 https://helpingstar.github.io/ml/regression_metrics/

RMSE와 MAE 모두 예측값의 벡터와 타깃값의 벡터 사이의 거리를 재는 방법이다. 

거리 측정에는 여러가지 방법이 있다.

- 제곱항을 합한 것의 제곱근(RMSE) 계산은 유클리드 노름에 해당 $l2$노름($||\cdot||_2$)이라고도 부른다.
- 절대값의 합을 계산하는 것은 l1 노름에 해당하며 $||\cdot||_1$로 표기 맨해튼 노름이라고도 함
- 일반적으로 원소가 n개인 벡터 v의 $l_k$노름은 아래 그림 참고 $l_0$은 단순히 벡터에 있는 0이 아닌 원소의 수이고, $l_\infty$는 벡터에서 가장 큰 절댓값이 됩니다.

![](https://velog.velcdn.com/images/hth623/post/469e4000-df73-4378-a80a-d79bb3ade025/image.png)

노름의 지수가 클수록 큰 값의 원소에 치우치며 작은값은 무시. 그래서 RMSE가 MAE보다 조금 더 이상치에 민감하다. 하지만 (종 모양 분포의 양 끝단처럼) 이상치가 매우 드물면 RMSE가 잘 맞아 일반적으로 사용됨

## 2.2.3 가정검사

마지막으로 지금까지 만든 가정을 나열하고 검사해보는 것을 권장

- 심각한 문제를 일찍 발견할 수도 있기 때문

# 2.3 데이터 가져오기

## 2.3.1 구글 코랩을 사용하여 예제 코드 실행하기

https://colab.research.google.com/github/rickiepark/handson-ml3/blob/main/

https://colab.research.google.com/drive/1cfbL5yoSvbOIcLCR9E6HPCyPUBKaRukY?usp=sharing